# Использование CROPS для работы с Yocto

Проект CROPS представляет готовые контейнеры для работы с проектами Yocto. Перед использованием CROPS необходимо установить последнюю версию Docker.

## Запуск контейнера CROPS

Для работы с Yocto мы будем использовать контейнер Poky Container из подпроекта [crops/poky-container](https://github.com/crops/poky-container).

Перейдите в каталог, в котором находится проект Yocto и выполните следующую команду:

```shell
docker run --cpus 5 --rm -it -v ${PWD}:/yocto crops/poky --workdir=/yocto bash
```

Данная команда выполнит запуск контейнера crops/poky, свяжет текущий каталог хоста с каталогом /yocto в контейнере и запустит команду bash с текущим каталогом /yocto. По окончаниии работы контейнер будет уничтожен.

Параметр ```--cpus 5``` ограничивает выделяемое контейнеру количество процессоров. Но, по факту, данный параметр ограничивет процессорное время. Помогает продолжать работу при выполнении длительной сборки Yocto. Для 8-ми ядерного процессора значение **-5** оказалось оптимальным. Можно изменить данный параметр для уже работающего контейнера:

``` shell
docker update --cpus 4 <containter>
```

При первом запуске Docker не найдет контейнер в локальном реестре и выполнит его загрузку с сети интернет. При последующих будет использоваться локальная версия контейнера.

## Работа с Yocto

После запуска контейнера, пользователю доступна командная строка интерпретатора bash с рабочим каталогом `/yocto`, связанным с каталогом хоста из которого была вызвана команда запуска контейнера.

В данной строке можно выполнять все работы, связанные с Yocto. По завершению работы контейнера, все артефакты, созданные в директории `/yocto`, будут доступны в директории хоста, который был указан при запуске.
